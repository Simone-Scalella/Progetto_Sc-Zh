
package univpm.esempio.model;
import java.util.Vector;

import org.json.JSONArray;
import org.json.JSONObject;
import org.springframework.web.client.RestTemplate;

import univpm.esempio.interf.Download;

public class ALL_post implements Download{
	private String[] metrics_arry = {"post_impressions","post_impressions_unique","post_reactions_by_type_total"};
	private Vector<page_post> posts = new Vector();
	String metrics = String.join(",", metrics_arry);
	
	public All_posts(String ID,String Access_token,String metrics){
		JSONArray Json_posts = GetPage(ID,Access_token,metrics).getJSONArray("data");
		for (Object pippo : Json_posts ) {
			posts.add(new page_post((JSONObject)pippo));
		}
	}
	
	
	public JSONObject GetPage(String ID,String Access_token,String metrics) {
		//TODO definire oggetto erorre e fare try catch
    	//try(errorboj = respose) ...
    	JSONObject response = new JSONObject( new RestTemplate().getForObject("https://graph.facebook.com/"+ID+"/posts?fields=insights.metric("+metrics+")&access_token="+Access_token, String.class));
    	System.out.println("response is : "+ response);
    	return response;
}
}

